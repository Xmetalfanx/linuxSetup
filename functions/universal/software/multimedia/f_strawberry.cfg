
######################################################
# do i need to pass anything as $1 or can i use distro codenames? 
function getStrawberryURL_redo() {


      # I think at this point "${nameFormat}*.${fileFormat}" is detected
      case $distroBase in
        debian) programURL=$(curl -s ${strawberryDownload} | awk -F '"' '/${debian_codename}/ { print $2}')

          ;;
        fedora) programURL=$(curl -s ${strawberryDownload} | awk -F '"' '/fc${fedoraBranch}/ { print $2}')

          ;;
        opensuse)
          
          
          # FIRST leap versus TW
            # if Leap, then look for ${leapBranch}
        ;;
        ubuntu) programURL=$(curl -s ${strawberryDownload} | awk -F '"' '/${ubuntuBranch}/ { print $2}'
)

        ;;

      esac 


}


function getStrawberryURL() {

	# $1 is used to determine what package to download

	strawberryURL=$(curl -s "${githubBaseURL}/strawberrymusicplayer/strawberry/releases" | awk -F \" -v branch="$1" '$2 ~ branch && !/dbgsym/ {print $2;exit}')

	totalStrawberryURL="$githubBaseURL$strawberryURL"

	programURL=${totalStrawberryURL}
}

#####################################

# Nov 2022 idea: use the gitdownload function here too just have "AppImage" as fileFormat
function strawberryAppImage() {
  fileFormat="AppImage"

  # Nov 2022 way (not done or tested )
  gitDownload ${fileFormat}

  # old way - delete when gitDownload way works
  #	getStrawberryURL "AppImage"

	# Mark as executable
	sudo chmod +X $strawberryPackage
}

# Nov 2022 idea to simplify things
function StrawberryBranchDistroCheck() {

  ## Debian
  case $distroBranch in
    getStrawberryURL_redo
    metaExternalDownload ${programTitle} ${programURL} ;;
  esac


  # Fedora
  case $fedoraBranch in
    38|39|40) getStrawberryURL_redo "fc${fedoraBranch}"

    metaExternalDownload ${programTitle} ${programURL}  ;;
  esac


  # OpenSuse Leap and/or Tumbleweed

  if [ "$openSUSEBranch" = "leap" ]; then

    case $leapBranch in
      15.6) echo "no release for 15.6 yet"  ;;
      15.5) getStrawberryURL lp155
            metaExternalDownload ${programTitle} ${programURL} ;;
    esac


  elif [ "$openSUSEBranch" = "tumbleweed" ]; then
  	# this is in the tumbleweed default repo - nothing more is needed
    installApp "strawberry"

  fi

}


###############################################################################
# Meta function
function installStrawberry() {
  programName="strawberry"
  programTitle="Strawberry Media Player"
  programHomepage="https://www.strawberrymusicplayer.org/"
  strawberryDownload="https://www.strawberrymusicplayer.org/#download"

  PPASource=""

  clear
  fancy_message action "Installing $programTitle"


  # Nov 2022 idea: this may be redone (or maybe just the functions listed in the case's will be) to maybe all use "gitDownload" when i get that working
  case $distroBase in

    arch|solus) installApp "strawberry" ;;
    debian|fedora|opensuse) StrawberryBranchDistroCheck ;;
    ubuntu)

      debGetInstall && return

      fancy_message action "Adding Official Strawberry PPA" && installStrawberryPPA && fancy_message action "Installing Strawberry after the official PPA was added" && $install strawberry
      
      ;;

  esac

  userPrompt

}
