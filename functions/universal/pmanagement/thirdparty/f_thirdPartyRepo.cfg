##########################################################
# Packman Repo code start 

function pacmanLeapRepo()
{

    case $leapVersion in 

        15.0) packmanURL="http://ftp.gwdg.de/pub/linux/misc/packman/suse/openSUSE_Leap_15.0/" 
            sudo zypper ar -cfp 90 $packmanURL packman
        ;;

        15.1) packmanURL="http://ftp.gwdg.de/pub/linux/misc/packman/suse/openSUSE_Leap_15.1/ " 
            sudo zypper ar -cfp 90 $packmanURL packman
        
        ;;

    esac

}

# Pacman Repo 
function packmanSuseRepo()
{
	
    ## note to self: for consistency i should change packmanURL to repoURL .. that way the universal function can be slimmed down 
    
    echo -e "Installing Packman Repo "

	repoName="Pacman Repository"

    case $openSUSEBranch in 

    leap) 
        # Determine what version of Leap the user is on 
        pacmanLeapRepo 
        ;; 

    tumbleweed) packmanURL="http://ftp.gwdg.de/pub/linux/misc/packman/suse/openSUSE_Tumbleweed/"
    
        sudo zypper ar -cfp 90 $packmanURL packman
    
    ;; 
    
    esac 

    # Distro Upgrade 
    sudo zypper dup --from packman --allow-vendor-change


}

# End of Packman related code 
#############################################################



# function that runs if the extra repo is NOT detected 
function universalExtraRepos()
{
    ## RPM Fusion for Fedora 
    ## Packman for OpenSuse 

    #Only gets to this point of RPMFusion or Packman is NOT detected 

    case $distroBase in 

        fedora) 
        echo "Adding BOTH RPMFusion Free and Non-Free Repos"

        $install https://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm https://download1.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-$(rpm -E %fedora).noarch.rpm
        ;;

        opensuse) packmanSuseRepo ;; 

        *) return ;; 

    esac 

    ## May be redundent ... 
    ## Refresh repos 
    $refresh
}



# Meta function 
function thirdPartyRepoCheck()
{
    # Opensuse has pacman installed 
    # Fedora has RPMFusion installed

    ########################################
    ## Assign extraRepoCheck 
    case $distroBase in 

    fedora) 
        extraRepoCheck="dnf repolist | grep rpmfusion"
        ;;

    opensuse)  
        extraRepoCheck="zypper lr | grep packman"
        ;;

    esac
    ##############################################

    if  [ -z "$extraRepoCheck" ]; then 

        echo -e "Extra Repos already enabled"
        return

    else 
        # Install third party repo 
        universalExtraRepos

    fi 

}
