## Declare Variables

mirrorlist="/etc/packman.d/mirrorlist"

# backup of original mirrorlist before my scripts do anything 
originalMirrorlistBackup="/etc/pacman.d/mirrorlist.original"

# backup file to be created "each time"
backupMirrorlist="/etc/pacman.d/mirrorlist.backup"
######################################################################

###################################################################################################
### Backup section 

## This could be for arch or Manjaro ... any arch base really .. 
function backupMirrorlist()
{
  
  ## Check if original mirrorlist has NOT been created/backed up yet 
  # makes backup of current mirrorlist but doesn't touch mirrorlist.original IF IT ALREADY EXISTS 
  if [ ! -f originalMirrorlistBackup ]; then

    echo -e "Making a backup of your original mirrorlist"
    sudo cp $mirrorlist $originalMirrorlistBackup
    echo -e "Your original Mirrorlist successfully backed up"
    clear

  else
    
    # backup mirrorlist to a .backup file, that will be changing with each run 
    echo -e "Making a backup of your current mirrorlist"
    sudo cp  $mirrorlist $backupMirrorlist
    echo -e "Your original Mirrorlist successfully backed up"
    clear

  fi

}

# End of the Backup Section 
################################################################################


###################################################################################################
# Arch related 

function optimizeArchMirrors()
{

  clear
  echo -e "About to Optimize Pacman Mirrors, while backing up  the current mirror list"

  # Backing up Current mirror list, TODO: Add option to "auto-reset" mirrorlist in the case of a bork
  backupMirrorlist

  # no need for reflector anymore 
  # https://wiki.archlinux.org/index.php/mirrors


  # offically from arch wiki - gets the six fastest mirrors
  rankmirrors -n 6 /etc/pacman.d/mirrorlist.backup > /etc/pacman.d/mirrorlist


  sudo pacman -Syy


}

function optimizeArchMirrorMeta()
{
  # Backup



  # backup original mirrorlist but doesn't touch the original backup if it already exists 
  backupMirrorlist

  #Optimize mirrors
  optimizeArchMirrors

  echo -e "You do not seem to be on an Arch based distro "

}

## End Arch Section 
#######################################################################################



#######################################################################################
## Manjaro Related 

function manjaroRankMirrors()
{
  clear 
  echo -e "About to run a command optimizing the download mirrors for Manjaro"
  sudo pacman-mirrors -f 0 && $refresh
  clear
  echo -e "Mirrors have been optimized and updated, successfully "
  userPrompt
}

function manjaroRankMirrorsFastTrack()
{
  clear 
  echo -e "About to run a command optimizing the download mirrors for Manjaro, using the five fastest detected mirrors"
  sudo pacman-mirrors -f 5 && $refresh
  clear
  echo -e "Mirrors have been optimized and updated, successfully "
  userPrompt
}


## Do not use ... for now but keep the functionn 
function manjaroOptDBSpeed()
{
  #clear
  #echo -e "Attention: This command defragments Pacman's database, which boosts performance on slow hard drives but is harmful on SSDs. So, DO NOT use this command on SSDs! "
  #userPrompt 

  #sudo pacman-optimize && sync
  #userPrompt

  return 

}

## End Manjaro Section 
#####################################################################################
