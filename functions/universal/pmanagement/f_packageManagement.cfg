# logs the info on the last upgrade to a file 
function logUpgradeInfo()
{

  # the idea of this is to keep track (in my scripts anyway) of the last time the system was updated.   I do have a few ideas for why that may be needed that I am throwing around in my head.

  upgradeDate=$(date +%D%t:%r)

  echo -e "Last Upgraded:\t $distroBase $version \t$upgradeDate" >> updateInfo.txt

}

# Check if repo is installed/enabled
function repoCheck()
{
  case $distroBase in 

  fedora) 
    
      # if this is null, repo is not installed
      if [ $(dnf repolist | grep "fusion") ]; then
        # RPMFusion is installed
        return 
      else 
        # echo for a test only 
        echo -e "RPMFusion needs to be installed"
      fi      
    
    ;;

  opensuse) 
    return ;; 

  esac 


  # Idea: "if thirdparty repo is there, do not install it" ... "if it's NOT THERE, install it"

  
  
  case $distroBase in 

  fedora) 

    ## IF $thirdPartyRepo is detected, it is installed
    dnf repolist | grep "$thirdPartyRepo" ;; 

  esac 

}


############################################

## This will be the meta function for arch based stuff 
## Mirrors/Repos/whatever 
function optimizeRepo()
{
    ## Fedora  ... no need for extra checks, since the distroBase should be known here 
    if [ "$distroBase" == 'fedora' ]; then  
    
      su -c 'echo "fastestmirror=true" >> /etc/dnf/dnf.conf'
      userPrompt


    ## I need to do a check for arch but i CANT use distroBase since that will trigger if the distro is Manjaro too 


    # TODO: Check these vars ... they could be slightly wrong 
    ## If Manjaro 
    ## This number of checks may be overkill 
    elif  [ "$OSRELEASE_NAME" = "Manjaro Linux" ] || \
          [ "$OSRELEASE_ID" = "Manjaro Linux" ] || \
          [ "$LSBDESCRIPTON" = "ManjaroLinux" ]; then

      ## Call to Function 
      manjaroRankMirrors

    else
      echo "No Optimizations performed"
      return 
    
    fi


}

## Universal function to add sources 
## This IS the meta function 
function universalAddRepo()
{
  # $1 - Repo Name
  # $2 - Repo URL/Source 
 
  case $distroBase in 

  fedora) sudo dnf config-manager --add-repo $2 ;;
  opensuse)
        ## ANOTHER function had  "addrepo -f -n $1 $2"... what is -n ? 
        sudo zypper addrepo -f $2
        ;; 

  solus) 
      sudo eopkg add-repo $2 ;; 

  ubuntu) addPPA ;; 

  esac 
}

###################################################################################
## PPA Related 


# Asks if the user wants to install the software typically associated with the PPA in question 
function installPPAPackages()
{
  echo 
  echo -e "Would you like to install the packages typically associated with this PPA?"
  echo -e "Packages include: \t $packageNames"
  echo 
  read -p   "Your Choice?(Y/N):" installPPASelection

  case $installPPASelection in 

  [yY]|yes) 
      # echo = for debugging for now 
      echo -e "This would install $packageNames on your system"
      
      # $install $packageNames 
      
      ;; 

  # should NOT exit the scripts as a whole 
  [nN]|no) 
    # echo only for debugging 
    echo "You have chosen NOT to install $packageNames"
  
  return ;; 

  esac 


}


function addPPA()
{
    
    
    # call to function in /functions/ubuntu/PPAs/f_branchCheck.cfg 
    # check if PPA is supported by the current version of Ubuntu running 
    ppaBranchCheck


    case $PPASupported in 

    yes) 
      # echo -e "Adding $1 PPA"
      sudo apt-add-repository $ppaSource
      ;; 

    esac  
    ## ends the case if the PPA is supported 

    #Check if user wants to install the software typically associated with the PPA 
    ## Idea: i should make a var so if say the user wants to say NO or YES here it remembers and stops asking 
    installPPAPackages

  # Refreshes the repo 
  $refresh


}
## End of PPA Related  Functions 
################################################################################3


## Universal function to add sources 
## This IS the meta function 
function universalAddRepo()
{
  # $1 - Repo Name
  # $2 - Repo URL/Source 
 
  case $distroBase in 

  fedora) sudo dnf config-manager --add-repo $2 ;;
  opensuse)
        ## ANOTHER function had  "addrepo -f -n $1 $2"... what is -n ? 
        sudo zypper addrepo -f $1 $2
        ;; 

  solus) 
      sudo eopkg add-repo $2 ;; 

  ubuntu) addPPA ;; 

  esac 


}

## End Add Source/Repo Section 
################################################################

