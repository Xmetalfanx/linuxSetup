## Load config files


. $functionsDir/universal/pmanagement/includePackageManager.cfg
## some includes in other locations MAY be redundent now ...


## Misc Functions
## 2019: not sure this is needed anymore..
function paddingBorder()
{
  ## Doesn't appear to work atm, anyway
  printf "%*s" $COLUMNS | tr " " "="

}
##############################################################

function quitScript()
{
    clear
    echo "Goodbye"
    exit
}


function invalidSection()
{
    echo "invalid selection "
    sleep 2s
    x=1
}


function userPrompt()
{
  read -p "Press [Enter] to continue "
}


function packageManDetection()
{
  #naming this admit as I see naming a var "sudo" to be an issue down the road 
  
  
  if [ $(command -v pacman) ]; then 

      pmanager="pacman"

      install=$admin$pmanager" -S "
      refresh=$admin$pmanager" -$y"
      upgrade=$admin$pmanager" -Syu"


    elif [ $(command -v dnf ) ]; then 
      pmanager="dnf"
      
      install=$admin$pmanager" install"
      refresh=$admin$pmanager" check-update"
      update=$admin$pmanager" upgrade"

    #openSuse
    elif [ $(command -v zypper) ]; then
            pmanager="zypper"

            install=$admin$pmanager" install"
            refresh=$admin$pmanager" refresh"

            # update info missing due to up vs dup depending on what branch you are on 

    # Solus
    elif [ $(command -v eopkg) ]; then 
              pmanager="eopkg"

              install=$admin$pmanager" install"
              refresh=$admin$pmanager" "
              update=$admin$pmanager" up"

    # I dont like the way this looks 
    elif  [ $(command -v apt) ]; then 

            pmanager="apt"

            install=$admin$pmanager" install"
            refresh=$admin$pmanager" update"
            update=$admin$pmanager" upgrade"

    elif [ $(command -v apt-get) ]; then 

            pmanager="apt-get"

            install=$admin$pmanager" install"
            refresh=$admin$pmanager" update"
            update=$admin$pmanager" upgrade"

      # Send to function to get more info about say Debian vs Ubuntu and what Ubuntu spin it could be 
    fi 

}



###########################################################
## IDEA: make this displayable from various parts of the scripts so if people forget different info, they can just hit a button and this function is called

## the only point for this is TESTING only ... a normal user wouldn't see this function's output

function osreleaseFileOutput()
{

echo "OSRELEASE_NAME:" $OSRELEASE_NAME
  echo "OSRELEASE_IDLIKE: "  $OSRELEASE_IDLIKE
  echo "OSRELEASE_ID: " $OSRELEASE_ID
  echo "OSRELEASE_VERSIONID: " $OSRELEASE_VERSIONID
  echo "OSRELEASE_VERSION: " $OSRELEASE_VERSION

  echo
  echo "OSRELEASE_UBUNTU_CODENAME: " $OSRELEASE_UBUNTU_CODENAME
  echo

}

function distroPackageManagementOutput()
{
 #echo
  #echo -e "PACKAGE INFO test output"
  #echo "Your distro's install command is: " $install
  #echo "Your distro's refresh command is: " $refresh
  #echo "Your distro's update/upgrade command is: " $update
  #echo

  return 

}

function mainDisplayDistroInfo()
{
  # clear
  # osreleaseFileOutput

  #######################################################
  ## Keep for now ...
  ## echo -e "Your Desktop Environment:\t\t\t ${bold}$desktopNameWVersion ${completeReset}"
  ## echo -e "Your GTK Version:\t\t\t\t ${bold} ${gtkVersion:0:7} ${completeReset} \n"
  #########################################################

  # distroPackageManagementOutput
  
  # echo "Your Desktop: " $DE
  #echo
  #echo "install software test: $install $software"
  #echo
  #echo "GTK Version Detected: " $gtkVersion
  #userPrompt

  echo -e "Your distro's End of Life is: $EOL"
}


##########################################################################################

function checkForCommand()
{
  if [ "$(locate $1)" ];then 
      echo -e "lsb_release found on this system "

  else
      packageManDetection

      # echo -e "lsb_release is not detected "

      $install $1

  fi

}


function intialTasks()
{
  ## Intial tasks to run before even displaying the menu

  ## Issue I see ... the issue is I need to use inxi to get info to see what the distroBase is; HOWEVER, if inxi is NOT INSTALLED, the detection will have issues ... so "which comes first?"

  # Gets info about distro
  # This is located in the f_distoCheck.cfg file
  printf "Getting Info about distro..\n"

  intialChecks

  # Displays some info about the distro used
  ## I think this is a test thing of output only ... for now
  ## reformatting it and still displaying it may be a good idea
  
  mainDisplayDistroInfo

}

##################################################################3

# Similar to a "run all tasks" script, this will be the function that runs all the tasks that would be in the ForME scripts (maybe removed at some point from that folder )

## When this is called ... all the general checks and specific checks are DONE ... no need to redo checks

function xmetalTasks()
{
  # optimize mirrors/repo function
  ## for faster downloads
  # Location: functions/universal/pmanagement/f_pmanagement.cfg
  
  echo -e "Optimizing Mirrors/repos"
  optimizeRepo

  ##################################################################

  # Universal Updater function here
  universalUpdate

  #################################################################
  # Third party repo function
    ## This doesn't say add the cinnamon specific repos for say OpenSuse TW ..
    ## THIS DOES add (if Fedora) RPMFusion [both], (if openSuse) the general pacman repo


  universalExtraRepos

  ####################################################################


  # Codec installation
  # location: /functions/universal/software/f_multimediaSoftware.cfg
  echo -e "Installing Codecs (if needed)"
  universalCodecInstall

  #######################################################################

  # Add Common software, function
  echo -e "Installing Commonly used Apps "
  universalSoftwareInstaller
  ###########################################


  # Install OMF - fish shell, Oh-My-Fish for the fish shell, and some OMF addons
  # location: /function/universal/software/f_cli_related.cfg
  metaFishShell

}
